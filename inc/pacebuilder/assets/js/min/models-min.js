var ptPbApp=ptPbApp||{};ptPbApp.Models=ptPbApp.Models||{},function(e,t,$,i,n){"use strict";n.Models.Section=t.Model.extend({defaults:{id:null,css_class:"",content_type:"boxed",bg_image:"",bg_attach:"fixed",bg_color:"",text_color:"",padding_top:"30px",padding_bottom:"30px",border_top_width:"0px",border_bottom_width:"0px",border_top_color:"#e5e5e5",border_bottom_color:"#e5e5e5",hasRows:!0,rowNum:0,admin_label:"Section"},initialize:function(){null!==this.get("id")&&this.get("id")||this.set("id",["pt_pb_section_",n.Sections.length+1,Math.round((new Date).valueOf()/1e3)].join("_")),this.importRows(),n.ModulesList={},i.each(n.Models,function(e,t){t.match(/.Module/)&&(n.ModulesList[t]=(new n.Models[t]).defaults)})},importRows:function(){this.set({rows:new n.Collections.Row,pre:n.getInputPrefix(this.get("id"))}),i.each(this.get("row")||[],this.addRow,this),this.unset("row",{silent:!0})},addRow:function(e){e=e||{},e.id=[this.get("id"),"row",this._getRowNum()].join("__");var t=new n.Models.Row(e);return this.get("rows").add(t),t},toJSON:function(e){var i=t.Model.prototype.toJSON.call(this);return e&&e.rows&&(delete i.rows,i.row=this.get("rows").toJSON({content:!0})),i},_getRowNum:function(){return this.set("rowNum",this.get("rowNum")+1).get("rowNum")}}),n.Models.Row=t.Model.extend({defaults:{id:"",parent:"",type:"columns",content_type:"parent",padding_top:"0px",padding_bottom:"0px",vertical_align:"default",gutter:"yes",admin_label:""},initialize:function(){this.set("pre",n.getInputPrefix(this.id)),this.importContent()},importContent:function(){var e=this.get("id");if(this.set("content",new n.Collections.Column),this.get("col"))i.each(this.get("col")||[],this.addColumn,this),this.set("type","columns").unset("col",{silent:!0});else if(this.get("slider")){var t=i.filter(this.get("slider"),function(e,t){return $.isNumeric(t)}),o=i.reduce(this.get("slider"),function(e,t,i){return $.isNumeric(i)||(e[i]=t),e},{});this.set({content:this.addSlider(o,t),type:"slider"}).unset("slider",{silent:!0})}else if(this.get("gallery")){var s=i.filter(this.get("gallery"),function(e,t){return $.isNumeric(t)}),l=i.reduce(this.get("gallery"),function(e,t,i){return $.isNumeric(i)||(e[i]=t),e},{});this.set({content:this.addGallery(l,s),type:"gallery"}).unset("gallery",{silent:!0})}else this.get("generic_slider")?this.set({content:this.addGenericSlider(this.get("generic_slider")),type:"generic-slider"}).unset("generic_slider",{silent:!0}):this.get("columns")&&(i.each(this.get("columns"),function(t,i){this.get("content").add(new n.Models.Column({id:[e,"col",i+1].join("__"),type:t}))},this),this.unset("columns",{silent:!0}))},addColumn:function(e){e=e||{},e.id=[this.get("id"),"col",this._getColNum()].join("__");var t=new n.Models.Column(e);return this.get("content").add(t),t},updateColumns:function(e){var t=this.get("content").toJSON({modules:!0}),n=[];i.each(e,function(e,o){var s={type:e};o<t.length&&(s=i.extend(t[o],s)),n.push(s)}),this.unset("content",{silent:!0}).set("col",n),this.importContent(),this.trigger("content-import")},addSlider:function(e,t){return e=e||{},e.slideArr=t||[],new n.Models.Slider(e)},addGenericSlider:function(e){return new n.Models.GenericSlider(e||{})},addGallery:function(e,t){return e=e||{},e.imageArr=t||[],new n.Models.Gallery(e)},isGallery:function(){return null!==this.get("content")&&"object"==typeof this.get("content")&&"get"in this.get("content")&&this.get("content").get("images")},isSlider:function(){return null!==this.get("content")&&"object"==typeof this.get("content")&&"get"in this.get("content")&&this.get("content").get("slides")},isGenericSlider:function(){return null!==this.get("content")&&"object"==typeof this.get("content")&&"get"in this.get("content")&&this.get("content").get("genSlider")},isColumns:function(){return null!==this.get("content")&&"object"==typeof this.get("content")&&"each"in this.get("content")},toJSON:function(e){var i=t.Model.prototype.toJSON.call(this);return e&&e.content&&(this.isColumns()?i.col=this.get("content").toJSON({modules:!0}):this.isSlider()?i.slider=this.get("content").toJSON({modules:!0}):this.isGallery()&&(i.gallery=this.get("content").toJSON({modules:!0})),delete i.content),i},_getColNum:function(){return this.get("content").length+1}}),n.Models.Column=t.Model.extend({defaults:{id:"",content:null,type:"1-1",parent:"",moduleNum:0,bg_color:"",border_left_width:"0px",border_right_width:"0px",border_left_color:"",border_right_color:""},initialize:function(){this.set({pre:n.getInputPrefix(this.get("id")),moduleList:n.ModulesList,modules:new n.Collections.Module}),this.importModules()},importModules:function(){this.get("module")&&(i.each(i.filter(this.get("module"),function(e,t){return $.isNumeric(t)}),this.addModule,this),this.unset("module",{silent:!0}))},addModule:function(e){e=e||{};var t=e&&e.type?this.properName(e.type):"";if(!n.Models[t])return!1;var o=this._getModuleNum(),s=new n.Models[t](i.extend(e,{id:[this.get("id"),"module",o].join("__")}));return this.get("modules").add(s),s},properName:function(e){return e=e||this.get("type"),e.toProperCase().replace(/module/,"")+"Module"},toJSON:function(e){var i=t.Model.prototype.toJSON.call(this);return e&&e.modules&&(delete i.modules,i.module=this.get("modules").toJSON()),i},_getModuleNum:function(){var e=this.get("moduleNum");return++e,this.set("moduleNum",e),e}}),n.Models.Slider=t.Model.extend({defaults:{id:"",css_class:"",slides:"",height:"400px",autoplay:"true",animation:"slit",interval:"4000",speed:"800",admin_label:"Slider",title:"Edit Slider",slideNum:0},initialize:function(){this.set({pre:n.getInputPrefix(this.get("id")),slides:new n.Collections.Slide}),this.importSlides()},importSlides:function(){this.get("slideArr")&&(i.each(this.get("slideArr")||[],this.addSlide,this),this.unset("slideArr",{silent:!0}))},addSlide:function(e){e=e||{},e.id=[this.get("id"),this._getSlideNum()].join("__");var t=new n.Models.Slide(e);return this.get("slides").add(t),t},toJSON:function(e){var n=t.Model.prototype.toJSON.call(this);if(e&&e.modules){var o=this.get("slides").toJSON();n=i.extend(n,i.object(i.keys(o),o)),delete n.slides}return n},_getSlideNum:function(){return this.set("slideNum",this.get("slideNum")+1).get("slideNum")}}),n.Models.Slide=t.Model.extend({defaults:{id:"",parent:"",css_class:"",bg_image:"",bg_color:"#ddd",bg_pos_x:"center",bg_pos_y:"center",content_pos_x:"center",content_pos_y:"center",heading:"",content:"",heading_color:"",heading_bg_color:"",heading_size:"42px",text_color:"",text_bg_color:"",text_size:"18px",orientation:"vertical",slice1_rotation:"10",slice2_rotation:"-15",slice1_scale:"1.5",slice2_scale:"1.5",admin_label:"Slide",title:"Edit Slide"},initialize:function(){this.set({pre:n.getInputPrefix(this.get("id"))})}}),n.Models.GenericSlider=t.Model.extend({defaults:{id:"",css_class:"",slider_id:"",type:"",admin_label:"Slider",title:"Edit Slider",itemNum:0,genSlider:!0},initialize:function(){this.set({pre:n.getInputPrefix(this.get("id"))})}}),n.Models.Gallery=t.Model.extend({defaults:{id:"",css_class:"",images:"",shape:"rounded",columns:"four",padding:"yes",admin_label:"Gallery",title:"Edit Gallery",imageNum:0},initialize:function(){this.set({pre:n.getInputPrefix(this.get("id")),images:new n.Collections.GImage}),this.importImages()},importImages:function(){this.get("imageArr")&&(i.each(this.get("imageArr")||[],this.addImage,this),this.unset("imageArr",{silent:!0}))},addImage:function(e){e=e||{},e.id=[this.get("id"),this._getImageNum()].join("__");var t=new n.Models.GImage(e);return this.get("images").add(t),t},toJSON:function(e){var n=t.Model.prototype.toJSON.call(this);if(e&&e.modules){var o=this.get("images").toJSON();n=i.extend(n,i.object(i.keys(o),o)),delete n.images}return n},_getImageNum:function(){return this.set("imageNum",this.get("imageNum")+1).get("imageNum")}}),n.Models.GImage=t.Model.extend({defaults:{id:"",css_class:"",src:"",post_id:"",href:"",title:"",desc:"",parent:"",admin_label:"Image",icon:"format-image"},initialize:function(){this.set({pre:n.getInputPrefix(this.get("id"))})}}),n.Models.Module=t.Model.extend({initialize:function(){this.set({pre:n.getInputPrefix(this.get("id"))})},properName:function(e){return e=e||this.get("type"),e.toProperCase().replace(/module/,"")+"Module"}}),n.Models.ImageModule=n.Models.Module.extend({defaults:{id:"",css_class:"",src:"",alt:"",title:"",href:"",animation:"",lightbox:!1,target:"",align:"left",margin_bottom:"20px",padding_top:"0px",padding_bottom:"0px",padding_left:"0px",padding_right:"0px",type:"image",parent:"",admin_label:"Image",icon:"format-image"}}),n.Models.TextModule=n.Models.Module.extend({defaults:{id:"",animation:"",content:"",margin_bottom:"20px",padding_top:"0px",padding_bottom:"0px",padding_left:"0px",padding_right:"0px",type:"text",parent:"",admin_label:"Text",icon:"editor-paragraph"}}),n.Models.HovericonModule=n.Models.Module.extend({defaults:{id:"",animation:"",icon:"heart",size:3,href:"",color:"#27ae60",hover_color:"#fff",title:"",content:"",margin_bottom:"20px",padding_top:"0px",padding_bottom:"0px",padding_left:"0px",padding_right:"0px",type:"hovericon",parent:"",admin_label:"Hover Icon"}}),n.Models.FeatureboxModule=n.Models.Module.extend({defaults:{id:"",animation:"",icon:"awards",size:3,href:"",color:"#27ae60",hover_color:"#fff",title:"",content:"",margin_bottom:"20px",padding_top:"0px",padding_bottom:"0px",padding_left:"0px",padding_right:"0px",type:"featurebox",parent:"",admin_label:"Feature Box"}})}(window,Backbone,jQuery,_,ptPbApp);